

<html lang="en">
<head>
    <title>Accuband C775FF Calculation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <style>
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black;
        }
        .tooltip-inner {
            white-space: pre-wrap;
        }
            .tooltip .tooltiptext {
                visibility: hidden;
                width: 120px;
                background-color: #555;
                color: #fff;
                text-align: center;
                border-radius: 6px;
                padding: 5px 0;
                position: absolute;
                z-index: 1;
                bottom: 125%;
                left: 50%;
                margin-left: -60px;
                opacity: 0;
                transition: opacity 0.3s;
            }

                .tooltip .tooltiptext::after {
                    content: "";
                    position: absolute;
                    top: 100%;
                    left: 50%;
                    margin-left: -5px;
                    border-width: 5px;
                    border-style: solid;
                    border-color: #555 transparent transparent transparent;
                }

            .tooltip:hover .tooltiptext {
                visibility: visible;
                opacity: 1;
            }


        .formDivA {
            padding: 10px;
            border: 2px;
            border-color: green;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }
        .formDivB {
            padding: 10px;
            border: 2px;
            border-color:cadetblue;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }
        .formDivC {
            padding: 10px;
            border: 2px;
            border-color: lightgrey;
            border-style: solid;
            border-top-style: solid;
            border-right-style: solid;
            border-bottom-style: solid;
            border-left-style: solid;
        }
        input:invalid {
            border: 2px dashed red;
        }

        input:invalid:required {
            border: 2px dashed green;
        }

        input:valid {
            border: 1px solid black;
        }
 
        /* Style the button that is used to open and close the collapsible content */
        .collapsible {
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
            padding: 10px;
            width: 10%;
            border: none;
            text-align: center;
            outline: none;
            font-size: 15px;
        }

            /* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
        .active, .collapsible:hover {
                background-color: lightgreen;
        }

        /* Style the collapsible content. Note: hidden by default */
        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f1f1f1;
        }

    </style>


</head>


<body>
    <div class="row">
        <div class="col-2 text-center">
        </div>
        <div class="col-2 text-center">
            <img src="https://kelk.com/sites/default/files/screenshot.png" alt="Home" class="mr-2">
        </div>

        <div class="col-6 text-right">
            <h2 style="color: blue;">ACCUBAND C775FF WIDTH GAGE</h2>
        </div>
    </div>
    <hr />
    <div class="row">
        <div class="col-2 text-center">
        </div>
        <!-- Input Minimum Strip Width -->
        <!-- Input Maximum Strip Width -->
        <div class="col-4 text-center">
            <h3 style="color: green;">1. Input Data</h3>


            <div class="formDivA">
                <form>
                    <!-- Input Minimum Strip Width -->
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> Minimum Strip Width:</span>
                        </div>
                        <input type="number" class="form-control" id="minWidth" required>

                        <div class="input-group-append">
                            <span class="input-group-text"> mm </span>
                        </div>
                    </div>
                    <!-- Input Maximum Strip Width -->
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> Maximum Strip Width:</span>
                        </div>
                        <input type="number" class="form-control" id="maxWidth" placeholder="" required>
                        <div class="input-group-append">
                            <span class="input-group-text"> mm </span>
                        </div>
                    </div>
                </form>
            </div>

        </div>

        <!-- Input Maximum  CLD -->
        <!-- Input Maximum HOP -->
        <!-- Input Preferred Installation Height -->

        <div class="col-4 text-center">
            <div class="formDivA">
                <form>
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="CLD max 100mm"> Maximum  CLD:</span>
                        </div>
                        <input type="number" class="form-control" id="maxCLD" max="105" required>
                        <div class="input-group-append">
                            <span class="input-group-text"> mm </span>
                        </div>
                    </div>

                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="HOP max 30mm">Maximum HOP:</span>
                        </div>
                        <input type="number" class="form-control" id="maxHOP" max="30" required>
                        <div class="input-group-append">
                            <span class="input-group-text"> mm </span>
                        </div>
                    </div>

                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="Leave Preferred Installation Height blank for new installation">Preferred Installation Height:</span>
                        </div>
                        <input type="number" class="form-control" id="PreferredHeight" max="1600">
                        <div class="input-group-append">
                            <span class="input-group-text"> mm </span>
                        </div>
                    </div>


                </form>
            </div>



        </div>

        <div class="col-2 text-center">

        </div>

    </div>

    <!-- Button calculate -->
    <div class="row">


        <div class="col-6 text-center">

        </div>
        <div class="col-2 text-left">
            <button class="btn btn-primary btn" type="submit" id="calculateButton" onclick="calculate();" data-toggle="tooltip" data-placement="top" title="">Calculate</button>
        </div>


    </div>
    <div class="row">
        <div class="col-10 text-right">
            <h4 style="color: grey;">Results</h4>
        </div>
    </div>

    <div class="row">
        <div class="col-2 text-center">
        </div>
        <div class="col-4 text-center">
            <div class="formDivB">
                <form>
                    <div class="input-group mb-3 input-group-sm">
                        <span class="border-left"></span>

                        <div class="input-group-prepend">
                            <label class="input-group-text" for="inputGroupSelect01">Scanner Orientation:</label>
                        </div>
                        <select class="custom-select" id="selOrientation">
                            <option value="" disabled selected>Choose</option>
                            <option value="LEFT">Left</option>
                            <option value="RIGHT">Right</option>
                        </select>
                    </div>

                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="inputGroupSelect02">Communication Protocol:</label>
                        </div>
                        <select class="custom-select" id="HostCommunicationProtocol" onchange="HCPfunction()">
                            <option value="TS-542">TS-542 TCP-IP</option>
                            <option value="TS-549">TS-549 ProfiBUS/ProfiNET</option>
                        </select>
                        <select class="custom-select" id="L2MC" name="DiscreteMC">
                            <option value="0">without M/C</option>
                            <option value="1">with 1 M/C</option>
                        </select>
                    </div>


                </form>
            </div>
            <h3 style="color: cadetblue;">2.Scope of Supply</h3>

        </div>

        <div class="col-4 text-center">

            <div class="formDivC">
                <form>
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="Distance from Bottom Mounting Hole to Pass Line (900~1600)mm">Installation Height:</span>
                        </div>
                        <input type="text" class="form-control" id="instHeight" placeholder="HEIGHT" max="1600" disabled>
                        <div class="input-group-append">
                            <span class="input-group-text">mm</span>
                        </div>
                    </div>
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text" data-toggle="tooltip" data-placement="top" title="Distance Between Center of Two Stereo Cameras">Camera Separation:</span>
                        </div>
                        <input type="text" class="form-control" id="cameraSeparation" placeholder="SEP" aria-label="CameraSeparation" aria-describedby="basic-addon1" disabled>
                        <div class="input-group-append">
                            <span class="input-group-text">mm</span>
                        </div>
                    </div>
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Lens Focus Length:</span>
                        </div>
                        <input type="text" class="form-control" id="lensFocus" placeholder="LENS" disabled>
                        <div class="input-group-append">
                            <span class="input-group-text">mm</span>
                        </div>
                    </div>
                </form>
            </div>

        </div>
        <div class="col-2 text-center">
        </div>
    </div>


    <div class="row">
        <div class="col-1 text-center">
        </div>
        <div class="col-5 text-center">
            <div class="formDivB">
                <form>
                    <div class="input-group mb-3 input-group-sm">

                        <div class="input-group-prepend">
                            <input type="checkbox" id="selCalibrator" checked>
                            <label class="input-group-text" for="inputGroupSelect03" id="lableProfi" >Calibrator equipment is included</label>
                        </div>
                      </div>

                        <div id="ProfiOptions">
                            <div class="input-group mb-3 input-group-sm">

                                <div class="input-group-prepend">
                                    <input type="checkbox" id="selProfiBusNet">
                                    <label class="input-group-text" for="inputGroupSelect03" id="lableProfi">ProfiBUS/ProfiNET</label>
                                </div>
                                <select class="custom-select" id="selectedProfi" name="selectedProfi">

                                    <option value="" disabled selected>Choose Type</option>
                                    <option value="PB">ProfiBUS</option>
                                    <option value="PN">ProfiNET</option>
                                </select>
                                <select class="custom-select" id="ProfiPS" name="ProfiPS" data-toggle="tooltip" data-placement="top" title="">
                                    <option value="" disabled selected>To Be Installed</option>
                                    <option value="DC">Inside Power Supply Assembly</option>
                                    <option value="AC">Outside Power Supply Assembly</option>
                                </select>

                                <select class="custom-select" id="ProfiMC" name="ProfiMC">
                                    <option value="0">without M/C</option>
                                    <option value="1">with 1 M/C</option>
                                </select>


                            </div>
                        </div>
                        <div id="WagoOptions">

                            <div class="input-group mb-3 input-group-sm">

                                <div class="input-group-prepend">
                                    <input type="checkbox" id="selDiscrete">
                                    <label class="input-group-text" for="inputGroupSelect04">Discrete IO</label>
                                </div>

                                <select class="custom-select" id="DiscreteInput" name="DiscreteInput">
                                    <option value="" disabled selected>Input</option>
                                    <option value="V">+/-10V</option>
                                    <option value="C">4-20mA</option>
                                </select>

                                <select class="custom-select" id="DiscreteOutput" name="DiscreteOutput">
                                    <option value="" disabled selected>Output</option>
                                    <option value="V">+/-10V</option>
                                    <option value="C">4-20mA</option>
                                </select>
                                <select class="custom-select" id="DiscreteMC" name="DiscreteMC">
                                    <option value="0">without M/C</option>
                                    <option value="1">with 1 M/C</option>
                                </select>


                            </div>
                        </div>

                        <div class="input-group mb-3 input-group-sm">

                            <div class="input-group-prepend">
                                <input type="checkbox" id="selKIP" value="PL055640-1" name="KIP Software CD">
                                <label class="input-group-text" for="inputGroupSelect04">Operator's Station</label>
                            </div>

                            <select class="custom-select" id="selKIPQTY" name="selKIPQTY">
                                <option value="0" disabled selected>QTY</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                            </select>

                            <select class="custom-select" id="selectedPC" name="selectedPC">
                                <option value="1">KELK 1U PC</option>
                                <option value="2">KELK PC+M/C</option>
                                <option value="">KIP ONLY</option>
                            </select>


                        </div>


                </form>
            </div>
        </div>


        <div class="col-4 text-center">
            <div class="formDivC">
                <h4>Calculated Field of View</h4>

                <form>
                    <div class="input-group mb-3 input-group-sm">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Width Range @max HOP:</span>
                        </div>
                        <input type="text" class="form-control" id="FOVatHOP" disabled>

                        <div class="input-group-append">
                            <span class="input-group-text">mm</span>
                        </div>

                    </div>
                    <div class="input-group mb-3 input-group-sm">

                        <div class="input-group-prepend">
                            <span class="input-group-text"> Width Range  @Pass Line:</span>
                        </div>
                        <input type="text" class="form-control" id="FOVPassline" disabled>
                        <div class="input-group-append">
                            <span class="input-group-text">mm</span>
                        </div>



                    </div>
                </form>
            </div>


        </div>
        <div class="col-2 text-center">
        </div>
    </div>

    <div class="row">
        <div class="col-6 text-center">
            <button class="btn btn-primary btn" type="submit" id="workorderButton" onclick="download_csv();" data-toggle="tooltip" data-placement="top" title="">Generate WorkOrder</button>
        </div>
        <div class="col-5 text-left">
            <button class="btn btn-info btn" type="button" id="helpButton" color="green" data-toggle="tooltip" data-placement="top" title="">HELP</button>
        </div>
    </div>
</body>
</html>


<script>
      /*
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        });
    }
        */

    $(document).ready(function () {   //same as: $(function() {
  
        document.getElementById("ProfiOptions").style.display = 'none';
    });

    $('#ProfiPS').on('change', function () {
       // document.getElementById("gageLOcation").style.color = 'black';

        document.getElementById("ProfiMC").value = '0';


        if ($(this).val() == 'DC') {

            document.getElementById("ProfiMC").style.display = 'none';

        } else {
            document.getElementById("ProfiMC").style.display = 'block';

        }

    });

    $('#selOrientation').on('change', function () {
        document.getElementById("selOrientation").style.borderColor = 'black';

    });

    $('#DiscreteInput').on('change', function () {
        document.getElementById("DiscreteInput").style.borderColor = 'black';

    });

    $('#DiscreteOutput').on('change', function () {
        document.getElementById("DiscreteOutput").style.borderColor = 'black';

    });

    $('#selKIPQTY').on('change', function () {
        document.getElementById("selKIPQTY").style.borderColor = 'black';

    });

    $('#selectedProfi').on('change', function () {
        document.getElementById("selectedProfi").style.borderColor = 'black';

    });

    $('#ProfiPS').on('change', function () {
        document.getElementById("ProfiPS").style.borderColor = 'black';

    });





    const minHeight = 900;
    const maxHeight = 1600;

    function validateHeight() {
        var element = document.getElementById("PreferredHeight");
        var vHeight = parseInt(element.value);
        if ((vHeight > maxHeight) || (vHeight < minHeight)) {
            document.getElementById("lensFocus").value = "test";

            element.style.color = "red";
        } else {

            element.style.color = "black";

        }

    }

    function HCPfunction() {
        document.getElementById("selDiscrete").checked = false;
        document.getElementById("L2MC").value = 0;

        if (document.getElementById("HostCommunicationProtocol").value != "TS-549") { //PROFIBUS
            document.getElementById("selProfiBusNet").checked = false
            document.getElementById("ProfiOptions").style.display = 'none';
            document.getElementById("WagoOptions").style.display = 'block';
            document.getElementById("L2MC").style.display = 'block';


   //         document.getElementById("L2MC").style.display = 'none';

        } else {  //TCP-IP
            document.getElementById("selDiscrete").checked = false;

            document.getElementById("selProfiBusNet").checked = true
            document.getElementById("ProfiOptions").style.display = 'block';
            document.getElementById("WagoOptions").style.display = 'none';
            document.getElementById("L2MC").style.display = 'none';

        }




    }

    var defaultCLD = 0;
    var defaultHOP = 0;
    var defaultminWidth = 610;
    var defaultmaxWidth = 1905;
    document.getElementById("maxCLD").value = defaultCLD;
    document.getElementById("maxHOP").value = defaultHOP;
    document.getElementById("minWidth").value = defaultminWidth;
    document.getElementById("maxWidth").value = defaultmaxWidth;
    document.getElementById("calculateButton").title = '1. Enter Centerline Deviation and Hop values. Note: CLD max = 100mm  and Hop max =30mm\n'
        + '2. For new installation leave the preferred Installation Height blank\n'
        + '3. For existing installation: Enter Preferred Installation Height(900 - 1600mm)\n'
        + '4. press Calculate'
    document.getElementById("workorderButton").title = '1. Choose Scanner Orientation\n'
        + '2. Choose Communication Protocol\n'
        + '3. Choose PrifiBus / ProfiNet\n'
        + '4. Choose HMI and IO options\n'
        + '5. Click Generate Work Order\n'
        + '6. Download Work Order in Excel File';

    document.getElementById("helpButton").title = '1. Enter Maximum and Minimum Material Width\n'
        + '2. Enter Centerline Deviation and Hop values.Note: CLD max = 100mm  and Hop max = 30mm\n'
        + '3.1 For new installation leave the Preferred Installation height blank.\n'
        + '3.2 For existing installations: Enter Preferred Installation Height note: limits(900-1600mm)\n'
        + '4. Click "Calculate" button to get design\n'
        + '5. Choose Scanner Orientation\n'
        + '6. Choose Communication Protocol\n'
        + '7. Choose HMI and IO options\n'
        +'8. Click "Generate Workorder" button to generate Work Order in Excel';

    document.getElementById("ProfiPS").title = 'Select DC 24V If Module to be installed in KELK Power Supply where DC24V is available ';





 //   var PreferredHeight
    var KELKPC1U = ['', 'D1', '', 'EA', '*09117', '19\" RackMounted 1U Compute', ' ', 'PUR', ' ', ' ', ' ', ' ', '1']
    var Monitor = ['', 'D2', '', 'EA', '*08018', '22\" Monitor ', ' ', 'PUR', ' ', ' ', ' ', ' ', '1']
    var Keyboard = ['', 'D3', '', 'EA', '*08836', 'Keyboard ', ' ', 'PUR', ' ', ' ', ' ', ' ', '1']
    var Mouse = ['', 'D4', '', 'EA', '*08837', 'Mouse ', ' ', 'PUR', ' ', ' ', ' ', ' ', '1']
    var DesktopMC = ['', 'D5', '', 'EA', '*07446', '100M MultiMode Desktop Media Converotr with Power Supply', ' ', 'PUR', ' ', ' ', ' ', ' ', '1']
    var KIP = ['', 'D6', '', 'EA', 'PL055640-1', 'KELK Instrumentation Panel CD', ' ', 'MFG', ' ', ' ', ' ', ' ', '1']
    var DiscreteIO = ['', 'B1', '1', 'EA', 'PL059820', 'Accuband C775FF Discrete IO Assembly', ' ', 'MFG', ' ', ' ', ' ', ' ', '1']
    var ProfiAssembly = ['', 'B1', '1', 'EA', 'PL059823', '', ' ', 'MFG', ' ', ' ', ' ', ' ', '1']
    var MediaConvertor = ['', 'B2', '1', 'EA', 'PL059823-DCM', 'Media Converotr Kit (To Be Installed in Item A6)', ' ', 'MFG', ' ', ' ', ' ', ' ', '1']


    var LineItem = [
        ['1', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemA = [
        ['1', 'A', '1', 'EA', 'C775FF-2500-50-L-A', 'ACCUBAND C775FF Width GAGE', ' ', 'MFG', ' ', ' ', ' ', ' ', ' '],
        ['2', 'A1', '1', 'EA', 'PL059338-2500-', 'Accuband C775FF SCANNER ASSEMBLY 2500mm ', ' ', 'PRD', ' ', ' ', ' ', ' ', '2'],
        ['3', 'A2', '2', 'EA', 'PL059180-50 ', 'STEREO CAMERA ASSEMBLY 50mm FL ', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['4', 'A3', '2', 'EA', 'PL059655', 'Nozzle AssemblyAccuband C775FF NOZZLE ASSEMBLY', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['5', 'A4', '2', 'EA', 'PL059495', 'Accuband C775FF FRONT LIGHT ASSEMBLY 1200mm', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['6', 'A5', '2', 'EA', 'PL059344', 'ACCUBAND C775FF COVER', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['7', 'A6', '1', 'EA', 'PL059527', 'Accuband C775FF POWER SUPPLY & PROCESSOR ASSEMBLY', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['8', 'A7', '1', 'EA', 'PL057296', 'Accuband C775FF CALIBRATOR SUPPORT KIT', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['9', 'A8', '1', 'EA', 'PL059771', 'Accuband C775FF Accessary kit', ' ', 'PRD', ' ', ' ', ' ', ' ', '1'],
        ['10', 'A9', '1', 'EA', '059772-1', 'Installation Information Label :CAMERA SEPARATION: 1475 mm INSTALLATION HEIGHT: 1190 mm ', ' ', 'REF', ' ', ' ', ' ', ' ', ''],
        ['11', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemB= [
        ['1', 'B', '', 'EA', '', 'ACCUBAND CABINET OPTION', ' ', '', ' ', ' ', ' ', ' ', '']
    ];

    var C775ItemC = [
        ['1', 'C', '1', 'EA', 'C775FF-CAL-A', 'ACCUBAND C775FF CALIBRATION EQUIPMENT', ' ', 'MFG', ' ', ' ', ' ', ' ', '3'],
        ['2', 'C1', '1', 'EA', 'PL059235', 'Accuband C775FF LONG CALIBRATOR', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
        ['3', 'C2', '1', 'EA', 'PL059242 ', 'Accuband C775FF SHORT CALIBRATOR', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
        ['4', 'C3', '1', 'EA', '*09185', 'Accuband C775FF CALIBRATOR STORAGE CASE', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
        ['5', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemD = [
        ['1', 'D', '', 'EA', '', 'OPERATOR\'S INTERFACE', ' ', '', ' ', ' ', ' ', ' ', '']
    ];
    var C775ItemG = [
        ['1', 'G', '', 'EA', '', 'ADDITIONAL FEATURE', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemH = [
        ['1', 'H', '', 'EA', '', 'ENGINEERING SERVICE', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', 'H1', '1', 'EA', '', 'Project Engineering', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['3', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemJ = [
        ['1', 'J', '', 'EA', '', 'COMMISSIONING AND TRAINING', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemK = [
        ['1', 'K', '', 'EA', '', 'DOCUMENTAION', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', 'K1', '1', 'EA', '90512', 'Accuband C775FF Width Gage User\'s Manuals', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['3', 'K2', '1', 'EA', '59811', ' System Drawing Package', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['4', 'K3', '1', 'EA', '', ' Documentation on KELK Network', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['5', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemS = [
        ['1', 'S', '', 'EA', '', 'SOFTWARE', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', 'S1', '1', 'EA', 'TS-542', 'Accuband C775FF Communication Protocol TCP-IP ', ' ', 'ENG', ' ', ' ', ' ', ' ', ''],
        ['3', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];
    var C775ItemT = [
        ['1', 'G', '', 'EA', '', 'ADDITIONAL PRODUCTION TESTING', ' ', '', ' ', ' ', ' ', ' ', ''],
        ['2', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    ];


    const stdLensFocalLengths = [41.50, 50.20, 59.90, 80.30];
    const CamberAngle = 3.0;  // fixed camera camber angle
    const CCD = 28.672 * (2048 - 24) / 2048; //edges are not detected in the first and last 12 pixels of CCD=28.336.
    const CameraSeparation = 99.60;
    const CalibratorHeightAbovePassLine = 78.0;
    const maxPositionError = 20.0;
    const HeightOffset = 80.0;  // different between bottom screw to camera height;
    var LensFocusLength = 50;
    var RequiredCameraSeparation = 0.0;
    var InstallationHeight = 0.0;


    function getFOV(F, HTP,HOP) {

        // F: Standard Schneider Lens Focal Lengths : Back Focus at Infinity
        // HTP: Camera Height above passline; 
        var HT = HTP - CalibratorHeightAbovePassLine;
        var S = CameraSeparation;
        var L = F + (F * F) / (Math.sqrt(HT * HT + S * S / 4) - F);
        var viewingAngle = 2 * Math.atan(CCD / (2 * L)) * 180 / Math.PI
 //       alert("viewingAngle=" + viewingAngle);

        var AA = viewingAngle / 2.0 - CamberAngle;
        var AB = viewingAngle / 2.0 + CamberAngle;
        var BA = viewingAngle / 2.0 + CamberAngle;
        var BB = viewingAngle / 2.0 - CamberAngle;

//        alert("AA=" + AA + "  :  " + "AB=" + AB + "  :  " + "BA=" + BA + "  :  " + "BB=" + BB + "  :  ");

        var AAI = CameraSeparation / 2 * Math.tan((90 - AA) * Math.PI / 180);    ;//=S/2*TAN((90-AA)*PI()/180)
        var ABI = -1.0* CameraSeparation / 2 * Math.tan((90 - AB) * Math.PI / 180);
        var ABAA = CameraSeparation / (Math.tan(AA * Math.PI / 180) - Math.tan(BA * Math.PI / 180));
        
//        alert("AAI=" + AAI + "  :  " + "ABI=" + ABI + "  :  " + "ABAA=" + ABAA);

      //  $test = $value === 0 ? 'it is zero!' : 'It is not zero.';
        var FOVH = ((HTP - HOP) > -1.0 * ABAA) ? 2 * (HTP - HOP + AAI) * Math.sin(AA * Math.PI / 180.0) : 2 * (HTP - HOP + ABI) * Math.sin(AB * Math.PI / 180.0);
        var FOVP = (HTP  > -1.0 * ABAA) ? 2 * (HTP  + AAI) * Math.sin(AA * Math.PI / 180.0) : 2 * (HTP  + ABI) * Math.sin(AB * Math.PI / 180.0);
//        alert('FOVH=' + FOVH+ '   :   '+ 'FOVP='+FOVP);




        return [FOVH,FOVP];// Field Of View @ HOP and @ Passline;
    }
    function calculate() {
        var bVal = false;

        var PreferredHeight = parseInt(document.getElementById("PreferredHeight").value)
        var HTP = minHeight; // camera height above passline; minimum height value;
        LensFocusLength = 50;

        var minStripWidth = parseInt(document.getElementById("minWidth").value);
        var maxStripWidth = parseInt(document.getElementById("maxWidth").value);
        var maxCLD = parseInt(document.getElementById("maxCLD").value);
        var maxHOP = parseInt(document.getElementById("maxHOP").value);

        var calculatedFOV = [0.0, 0.0];
// calculate camera seperation OK
        RequiredCameraSeparation = (minStripWidth + maxStripWidth) / 2; // Camera AB & CD separation
        document.getElementById("cameraSeparation").value = RequiredCameraSeparation;

        var cameraFOV = (maxStripWidth - minStripWidth) / 2 +maxCLD + maxPositionError; // required camera field of view


        if (PreferredHeight > minHeight + HeightOffset) {
            HTP = PreferredHeight - HeightOffset;
            calculatedFOV = getFOV(stdLensFocalLengths[1], HTP, maxHOP);
            if (calculatedFOV[0] < cameraFOV) {
                bVal = false;
                LensFocusLength = 40;
                calculatedFOV = getFOV(stdLensFocalLengths[0], HTP, maxHOP);
                if (calculatedFOV[0] > cameraFOV) {
                    bVal = true;
                }
            } else {
                bVal = true;
            } 
        }
//        alert('0cameraFOV @HOP =' + cameraFOV + '   :   ' + 'HTP=' + HTP + '   :   ' + 'FOVH=' + calculatedFOV[0] + '   :   ' + 'FOVP=' + calculatedFOV[1]);

        if (bVal == false) {

            for (HTP = minHeight; HTP < maxHeight; HTP += 1.0) {
                LensFocusLength = 50;
                calculatedFOV = getFOV(stdLensFocalLengths[1], HTP, maxHOP);

                if (calculatedFOV[0] > cameraFOV) {
                    bVal = true;
                    break;
                }
            }
        }

//        alert('1cameraFOV @HOP =' + cameraFOV + '   :   ' + 'HTP=' + HTP + '   :   ' + 'FOVH=' + calculatedFOV[0] + '   :   ' + 'FOVP=' + calculatedFOV[1]);

        if (bVal == false) {

            for (HTP = minHeight; HTP < maxHeight; HTP += 1.0) {
                LensFocusLength = 40;
                calculatedFOV = getFOV(stdLensFocalLengths[0], HTP, maxHOP);

                if (calculatedFOV[0] > cameraFOV) {
                    bVal = true;
                    break;
                }
            }
        }



 //       alert('2cameraFOV @HOP =' + cameraFOV + '   :   ' + 'HTP=' + HTP + '   :   ' + 'FOVH=' + calculatedFOV[0] + '   :   ' + 'FOVP=' + calculatedFOV[1]);


        InstallationHeight = HTP + HeightOffset;

        if (InstallationHeight > maxHeight) {
            document.getElementById("instHeight").style.color = "red";
        } else {
            document.getElementById("instHeight").style.color = "black";
        }

        document.getElementById("lensFocus").value = LensFocusLength;
        document.getElementById("instHeight").value = InstallationHeight;
        document.getElementById("cameraSeparation").value = RequiredCameraSeparation;


        maxStripWidth = Math.round(RequiredCameraSeparation + calculatedFOV[0] - maxPositionError - maxCLD);
        minStripWidth = Math.round(RequiredCameraSeparation - calculatedFOV[0] + maxPositionError + maxCLD);
        document.getElementById("FOVatHOP").value = minStripWidth + ' ~ ' + maxStripWidth;

        maxStripWidth = Math.round(RequiredCameraSeparation + calculatedFOV[1] - maxPositionError - maxCLD);
        minStripWidth = Math.round(RequiredCameraSeparation - calculatedFOV[1] + maxPositionError + maxCLD);
        document.getElementById("FOVPassline").value = minStripWidth + ' ~ ' + maxStripWidth;
    }
    function prepItemB() {
        var sel //= document.getElementById("selectedProfi");
        var mc = (document.getElementById("selKIP").checked && (document.getElementById("selectedPC").value==2) )? 1: 0;
        mc = parseInt(mc) + parseInt(document.getElementById("L2MC").value) + parseInt(document.getElementById("selDiscrete").checked?document.getElementById("DiscreteMC").value:0);
        mc = parseInt(mc) + parseInt(document.getElementById("selProfiBusNet").checked ? document.getElementById("ProfiMC").value : 0);
 //       alert(mc);

        C775ItemB = [
            ['1', 'B', '', 'EA', '', 'ACCUBAND ELECTRONICS OPTION', ' ', '', ' ', ' ', ' ', ' ', '']
        ];

        // discrete IO options
        if (document.getElementById("selDiscrete").checked) {
            DiscreteIO[0] = C775ItemB.length + 1
            DiscreteIO[1] = "B" + C775ItemB.length
            DiscreteIO[4] = 'PL059820-' + document.getElementById("DiscreteInput").value + document.getElementById("DiscreteOutput").value + 'W' + (document.getElementById("DiscreteMC").value=='1'? 'M':'');
            C775ItemB.push(DiscreteIO);
            console.log(C775ItemB);
    //        alert('WAGO='+ DiscreteIO);
        }

        // ProfiBus /Pronet options
        sel = document.getElementById("selectedProfi");
        if (document.getElementById("selProfiBusNet").checked) {
            ProfiAssembly[0] = C775ItemB.length + 1
            ProfiAssembly[1] = "B" + C775ItemB.length
            ProfiAssembly[4] = 'PL059823-' + document.getElementById("ProfiPS").value + document.getElementById("selectedProfi").value + (document.getElementById("ProfiMC").value=='1'?'M':'');

            ProfiAssembly[5] = 'Accuband C775FF ' + sel.options[sel.selectedIndex].text + ' Assembly'

            if (document.getElementById("ProfiPS").value == 'DC') { //installed in P/S
                switch (mc) {
                    case 1:
                        ProfiAssembly[4] = ProfiAssembly[4] + 'M';
                        break;
                    case 2:
                        ProfiAssembly[4] = ProfiAssembly[4] + 'MM';
                        break;
                    default:
                } 
                ProfiAssembly[5] = ProfiAssembly[5] +'  (To Be Installed in Item A6)  '         
            }

            C775ItemB.push(ProfiAssembly);
            console.log(C775ItemB);

    //        alert('ProfiAssembly='+ProfiAssembly);

        }

        if ((document.getElementById("ProfiPS").value != 'DC')&&(mc>0)) {

            MediaConvertor[0] = C775ItemB.length + 1
            MediaConvertor[1] = "B" + C775ItemB.length
            switch (mc) {
                case 1:
                    MediaConvertor[4] = 'PL059823-DCM';
                    break;
                case 2:
                    MediaConvertor[4] = 'PL059823-DCMM';
                    break;
                case 3:
                    MediaConvertor[4] = 'PL059823-DCMMM';
                    break;
                default:
            } 

            C775ItemB.push(MediaConvertor);
            console.log(C775ItemB);

   //         alert('MediaConvertor='+MediaConvertor);


        }




        LineItem[0] = C775ItemB.length + 1
        LineItem[1] = ''
        LineItem[2] = ''
        LineItem[3] = ''
        LineItem[4] = ''
        LineItem[5] = ''
        LineItem[7] = ''
        LineItem[12] = ''
        C775ItemB.push(LineItem.concat());
        console.log(C775ItemB)




    }


    function prepItemC() {


        if (document.getElementById("selCalibrator").checked) {

            C775ItemC = [
                ['1', 'C', '1', 'EA', 'C775FF-CAL-A', 'ACCUBAND C775FF CALIBRATION EQUIPMENT', ' ', 'MFG', ' ', ' ', ' ', ' ', '3'],
                ['2', 'C1', '1', 'EA', 'PL059235', 'Accuband C775FF LONG CALIBRATOR', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
                ['3', 'C2', '1', 'EA', 'PL059242 ', 'Accuband C775FF SHORT CALIBRATOR', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
                ['4', 'C3', '1', 'EA', '*09185', 'Accuband C775FF CALIBRATOR STORAGE CASE', ' ', 'PRD', ' ', ' ', ' ', ' ', ''],
                ['5', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
            ];

        } else {

            C775ItemC = [
                ['1', 'C', '', '', '', 'CALIBRATION EQUIPMENT', ' ', '', ' ', ' ', ' ', ' ', ''],
                ['2', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
            ];

        }






    }


    function prepItemD() {
        C775ItemD = [
            ['1', 'D', '', 'EA', '', 'OPERATOR\'S INTERFACE', ' ', '', ' ', ' ', ' ', ' ', '']
        ];

        var qty = document.getElementById("selKIPQTY").value;
        if ((document.getElementById("selKIP").checked) && ((document.getElementById("selectedPC").value == 1) || (document.getElementById("selectedPC").value == 2))) {
            // add KELK PC
            KELKPC1U[0] = C775ItemD.length + 1
            KELKPC1U[2] = qty
            C775ItemD.push(KELKPC1U);
            console.log(C775ItemD);
            //add Monitor
            Monitor[0] = C775ItemD.length + 1
            Monitor[2] = qty
            C775ItemD.push(Monitor);
            console.log(C775ItemD);
            //add Keyboard
            Keyboard[0] = C775ItemD.length + 1
            Keyboard[2] = qty
            C775ItemD.push(Keyboard);
            console.log(C775ItemD);
            //add Mouse
            Mouse[0] = C775ItemD.length + 1
            Mouse[2] = qty
            C775ItemD.push(Mouse);
            console.log(C775ItemD);
        }
        if ((document.getElementById("selKIP").checked) && (document.getElementById("selectedPC").value == 2)) {
            //add Media Convertor
            DesktopMC[0] = C775ItemD.length + 1
            DesktopMC[2] = qty
            C775ItemD.push(DesktopMC);
            console.log(C775ItemD);
        }


        if (document.getElementById("selKIP").checked) {
            //add KIP
            KIP[0] = C775ItemD.length + 1;
            KIP[1] = "D" + C775ItemD.length;
            KIP[2] = qty;
            C775ItemD.push(KIP);
            console.log(C775ItemD);
        }
        LineItem[0] = C775ItemD.length + 1
        LineItem[1] = ''
        LineItem[2] = ''
        LineItem[3] = ''
        LineItem[4] = ''
        LineItem[5] = ''
        LineItem[7] = ''
        LineItem[12] = ''
        C775ItemD.push(LineItem.concat());
        console.log(C775ItemD)

    }

    function prepare_lineItems() {
        var selectedOption;
 //       document.getElementById("PreferredHeight").value = 0;


 //       document.getElementById("PreferredHeight").value = sel.options[sel.selectedIndex].text;
        // finalize orientation
        var selectedOrenitation = document.getElementById("selOrientation").value;
        C775ItemA[0][4] = "C775FF-2500-" + LensFocusLength + "-" + selectedOrenitation.substr(0, 1) + "-A";

        C775ItemA[1][4] = "PL059338-2500-" + selectedOrenitation.substr(0, 1);
        C775ItemA[1][5] = "Accuband C775FF SCANNER ASSEMBLY 2500mm " + selectedOrenitation;
        C775ItemA[2][4] = "PL059180-" + LensFocusLength;
        C775ItemA[2][5] = "STEREO CAMERA ASSEMBLY " + LensFocusLength + " FL";
        C775ItemA[9][5] = "Installation Information Label: CAMERA SEPARATION= " + RequiredCameraSeparation + "mm; " + "INSTALLATION HEIGHT=" + InstallationHeight + "mm";

        // Host Communication Option
        selectedOption = document.getElementById("HostCommunicationProtocol").value;
        C775ItemS[1][4] = selectedOption;
        switch (selectedOption) {
            case "TS-542":
                C775ItemS[1][5] = 'Accuband V6 C775 - FF Communication Protocol'
                break;
            case "TBD":
                C775ItemS[1][5] = 'TBD Communication Protocol'
                break;
                defaule:
                C775ItemS[1][5] = 'Communication Protocol';
        }

        alert('10');



        prepItemB();
        prepItemC();

        prepItemD();


    }
    function validation() {
        var bVal = true;


        if (document.getElementById("selOrientation").value == '') {
            document.getElementById("selOrientation").style.borderColor = 'red';
            bVal = false;
        }


        if (document.getElementById("selDiscrete").checked) {
            if (document.getElementById("DiscreteInput").value == '') {
                document.getElementById("DiscreteInput").style.borderColor = 'red';
                bVal = false;
            }
            if (document.getElementById("DiscreteOutput").value == '') {
                document.getElementById("DiscreteOutput").style.borderColor = 'red';
                bVal = false;
            }


        };



        if (document.getElementById("selProfiBusNet").checked) {
            if (document.getElementById("selectedProfi").value == '') {
                document.getElementById("selectedProfi").style.borderColor = 'red';
                bVal = false;
            }
            if (document.getElementById("ProfiPS").value == '') {
                document.getElementById("ProfiPS").style.borderColor = 'red';
                bVal = false;
            }
        };
        if (document.getElementById("selKIP").checked) {
            if (document.getElementById("selKIPQTY").value == '0') {
                document.getElementById("selKIPQTY").style.borderColor = 'red';
                bVal = false;
            }
        };
        return bVal;

    }



    function download_csv() {
        var csv = 'C775FF,Item,QTY,UOM,PartNumber,Description,SN,Status,FolderDate,MFGDate,ShipDate,Tran,Crate\n';
        if (validation() == false) {
            return;
        }
        alert('0');

        prepare_lineItems();
        alert('1');
        C775Items = C775ItemA.concat(C775ItemB, C775ItemC, C775ItemD, C775ItemG, C775ItemH, C775ItemJ, C775ItemK, C775ItemS, C775ItemT);
            C775Items.forEach(function (row) {
                csv += row.join(',');
                csv += "\n";
            });

            console.log(csv);
            var hiddenElement = document.createElement('a');
            hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
            hiddenElement.target = '_blank';
            hiddenElement.download = 'C775FF.csv';
            hiddenElement.click();
        }



    function execute(){

        document.getElementById("PreferredHeight").value = "have a nice day"


    }</script>



